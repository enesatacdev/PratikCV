"use strict";exports.id=4908,exports.ids=[4908],exports.modules={44908:(a,b,c)=>{c.d(b,{C:()=>d,downloadPDF:()=>e,previewPDF:()=>f});class d{static{this.baseUrl="/api"}static optimizeCVData(a){return{personalInfo:{fullName:a.personalInfo?.fullName||a.fullName||"",email:a.personalInfo?.email||a.email||"",phone:a.personalInfo?.phone||a.phone||"",address:a.personalInfo?.address||a.address||"",title:a.personalInfo?.title||a.title||"",profilePhoto:a.personalInfo?.profilePhoto||a.profilePhoto||""},experiences:(a.experiences||a.experience||[]).slice(0,10).map(a=>({jobTitle:a.jobTitle||a.position||"",company:a.company||"",startDate:a.startDate||"",endDate:a.endDate||"",description:(a.description||"").substring(0,500)})),educations:(a.educations||a.education||[]).slice(0,5).map(a=>({degree:a.degree||"",school:a.school||"",department:a.department||"",startDate:a.startDate||"",endDate:a.endDate||""})),skills:(a.skills||[]).slice(0,20).map(a=>({name:a.name||a,level:a.level||3,category:a.category||"Teknik"})),certificates:(a.certificates||[]).slice(0,10).map(a=>({name:a.name||"",issuer:a.issuer||"",date:a.issueDate||a.date||""})),aboutMe:(a.aboutMe||"").substring(0,1e3),showProfilePhoto:a.showProfilePhoto||!1}}static async downloadPDF(a,b="modern"){try{let c=this.optimizeCVData(a),d=await fetch(`${this.baseUrl}/pdf/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cvData:c,templateId:b,options:{format:"A4",printBackground:!0}})});if(!d.ok)try{let a=await d.json();throw Error(a.error||`Server error: ${d.status}`)}catch(a){throw Error(`Server error: ${d.status}`)}let e=d.headers.get("content-type");if(e&&e.includes("application/json"))try{let a=await d.json();throw Error(a.error||"PDF generation failed")}catch(a){throw Error("PDF generation failed - invalid JSON response")}let f=await d.blob();if(0===f.size)throw Error("Empty PDF file received");let g=await f.arrayBuffer(),h=new Uint8Array(g);if(!String.fromCharCode(...h.slice(0,4)).startsWith("%PDF"))throw Error("Invalid PDF format received");let i=new Blob([g],{type:"application/pdf"}),j=URL.createObjectURL(i),k=`CV_${new Date().getTime()}.pdf`,l=document.createElement("a");l.href=j,l.download=k,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(j)}catch(a){throw a}}static async previewPDF(a,b="modern"){try{let c=this.optimizeCVData(a),d=await fetch(`${this.baseUrl}/pdf/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cvData:c,templateId:b,options:{format:"A4",printBackground:!0}})});if(!d.ok){let a=d.headers.get("content-type");if(a&&a.includes("application/json"))try{let a=await d.json();throw Error(a.error||"PDF generation failed")}catch(a){throw Error(`Server error: ${d.status}`)}else throw Error(`Server error: ${d.status}`)}let e=d.headers.get("content-type");if(e&&e.includes("application/json"))try{let a=await d.json();throw Error(a.error||"PDF generation failed")}catch(a){throw Error("PDF generation failed - invalid response")}let f=await d.blob(),g=URL.createObjectURL(f);window.open(g,"_blank"),setTimeout(()=>{URL.revokeObjectURL(g)},5e3)}catch(a){throw a}}static async getThumbnailImage(a,b="modern"){try{let c=document.createElement("canvas");c.width=300,c.height=400;let d=c.getContext("2d");if(!d)throw Error("Canvas context not available");d.fillStyle="#ffffff",d.fillRect(0,0,c.width,c.height),d.strokeStyle="#e5e7eb",d.lineWidth=2,d.strokeRect(0,0,c.width,c.height),d.fillStyle="#f9fafb",d.fillRect(10,10,c.width-20,80),d.fillStyle="#1f2937",d.font="bold 16px Arial",d.textAlign="center";let e=a.personalInfo?.firstName?`${a.personalInfo.firstName} ${a.personalInfo.lastName||""}`:a.personalInfo?.fullName||"CV \xd6nizlemesi";d.fillText(e,c.width/2,35),d.fillStyle="#6b7280",d.font="12px Arial",d.fillText(`${b} Şablonu`,c.width/2,55),d.fillStyle="#e5e7eb";for(let a=0;a<15;a++){let b=110+15*a,c=200*Math.random()+50;d.fillRect(20,b,c,8)}return d.fillStyle="#3b82f6",d.font="bold 14px Arial",d.textAlign="left",d.fillText("Kişisel Bilgiler",20,130),d.fillText("Deneyim",20,190),d.fillText("Eğitim",20,250),d.fillText("Yetenekler",20,310),c.toDataURL("image/png")}catch(c){return`data:image/svg+xml;base64,${btoa(`
        <svg width="300" height="400" xmlns="http://www.w3.org/2000/svg">
          <rect width="300" height="400" fill="#f3f4f6" stroke="#e5e7eb" stroke-width="2"/>
          <text x="150" y="50" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold" fill="#1f2937">
            ${a.personalInfo?.fullName||"CV \xd6nizlemesi"}
          </text>
          <text x="150" y="70" text-anchor="middle" font-family="Arial" font-size="12" fill="#6b7280">
            ${b} Şablonu
          </text>
          <rect x="20" y="90" width="260" height="280" fill="none" stroke="#e5e7eb" stroke-width="1"/>
          <text x="30" y="110" font-family="Arial" font-size="14" font-weight="bold" fill="#3b82f6">Kişisel Bilgiler</text>
          <text x="30" y="150" font-family="Arial" font-size="14" font-weight="bold" fill="#3b82f6">Deneyim</text>
          <text x="30" y="190" font-family="Arial" font-size="14" font-weight="bold" fill="#3b82f6">Eğitim</text>
          <text x="30" y="230" font-family="Arial" font-size="14" font-weight="bold" fill="#3b82f6">Yetenekler</text>
        </svg>
      `)}`}}static async getAvailableTemplates(){try{let a=await fetch(`${this.baseUrl}/templates`);if(!a.ok)throw Error("Failed to fetch templates");let b=await a.json();return b.success?b.data:[]}catch(a){return[]}}}let e=d.downloadPDF.bind(d),f=d.previewPDF.bind(d)}};