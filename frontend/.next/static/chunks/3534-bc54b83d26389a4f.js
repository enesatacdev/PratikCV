"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3534],{2729:(e,t,a)=>{a.d(t,{N:()=>i});let r={publicKey:"public_0A+aiL3RFDsLxyngk46pFYNpuxw=",urlEndpoint:"https://ik.imagekit.io/cpunfevuk",privateKey:a(9509).env.IMAGEKIT_PRIVATE_KEY},o=async()=>{try{let e=await fetch("/api/imagekit-auth");if(!e.ok)throw Error("ImageKit auth failed");return await e.json()}catch(e){throw e}},i={uploadPhoto:async(e,t)=>{try{if(e.size>5242880)throw Error("Dosya boyutu 5MB'dan b\xfcy\xfck olamaz");if(!e.type.startsWith("image/"))throw Error("L\xfctfen sadece resim dosyası se\xe7in");let a=await o(),i=new FormData;i.append("file",e),i.append("fileName",t||"photo_".concat(Date.now(),"_").concat(e.name)),i.append("folder","/profile-photos"),i.append("publicKey",r.publicKey),i.append("signature",a.signature),i.append("expire",a.expire),i.append("token",a.token);let n=await fetch("https://upload.imagekit.io/api/v1/files/upload",{method:"POST",body:i});if(!n.ok){let e=await n.json();throw Error(e.message||"Upload failed")}return(await n.json()).url}catch(e){throw e}},uploadCV:async(e,t)=>{try{if(e.size>0xa00000)throw Error("CV dosyası boyutu 10MB'dan b\xfcy\xfck olamaz");if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(e.type))throw Error("L\xfctfen PDF, JPG veya PNG formatında dosya y\xfckleyin");let a=await o(),i=new FormData;i.append("file",e),i.append("fileName",t||"cv_".concat(Date.now(),"_").concat(e.name)),i.append("folder","/cv-uploads"),i.append("publicKey",r.publicKey),i.append("signature",a.signature),i.append("expire",a.expire),i.append("token",a.token);let n=await fetch("https://upload.imagekit.io/api/v1/files/upload",{method:"POST",body:i});if(!n.ok){let e=await n.json();throw Error(e.message||"CV upload failed")}return(await n.json()).url}catch(e){throw e}},deletePhoto:async e=>{try{return(await fetch("/api/delete-photo/".concat(e),{method:"DELETE"})).ok}catch(e){return!1}},generateUrl:(e,t)=>{try{if(e.startsWith("data:")||e.startsWith("http"))return e;let a="https://ik.imagekit.io/cpunfevuk";if(!a)return e;let r="".concat(a,"/").concat(e);if(t&&Object.keys(t).length>0){let e=new URLSearchParams;t.width&&e.append("tr","w-".concat(t.width)),t.height&&e.append("tr","h-".concat(t.height)),t.quality&&e.append("tr","q-".concat(Math.round(100*t.quality))),e.toString()&&(r+="?".concat(e.toString()))}return r}catch(t){return e}},optimizePhoto:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:800,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:800,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.9;return new Promise((o,i)=>{let n=document.createElement("canvas"),s=n.getContext("2d"),l=new Image;l.onload=()=>{let{width:e,height:i}=l,u=e,c=i;e>i?e>t&&(u=t,c=i*t/e):i>a&&(c=a,u=e*a/i),n.width=u,n.height=c,null==s||s.drawImage(l,0,0,u,c),o(n.toDataURL("image/jpeg",r))},l.onerror=()=>i(Error("Resim y\xfcklenemedi"));let u=new FileReader;u.onload=e=>{var t;l.src=null==(t=e.target)?void 0:t.result},u.onerror=()=>i(Error("Dosya okuma hatası")),u.readAsDataURL(e)})},optimizeProfilePhoto:async e=>{try{return await i.optimizePhoto(e,600,600,.9)}catch(t){return await i.uploadPhoto(e)}},optimizeCVPhoto:async e=>{try{return await i.optimizePhoto(e,800,800,.95)}catch(t){return await i.optimizeProfilePhoto(e)}},uploadProfilePhoto:async(e,t)=>{try{let a=await i.optimizeCVPhoto(e),r="profile_".concat(t||"user","_").concat(Date.now());return{url:a,fileId:r}}catch(e){throw Error("Profil fotoğrafı y\xfcklenirken bir hata oluştu")}}}},6052:(e,t,a)=>{a.d(t,{AuthProvider:()=>l,h:()=>s});var r=a(5155),o=a(2115),i=a(5695);let n=(0,o.createContext)(void 0),s=()=>{let e=(0,o.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},l=e=>{let{children:t}=e,[a,s]=(0,o.useState)(null),[l,u]=(0,o.useState)(!0),c=(0,i.useRouter)(),d="http://localhost:5000/api";(0,o.useEffect)(()=>{m()},[]);let h=e=>{localStorage.setItem("authToken",e),document.cookie="authToken=".concat(e,"; path=/; max-age=").concat(604800,"; SameSite=Lax")},p=()=>{localStorage.removeItem("authToken"),document.cookie="authToken=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT; SameSite=Lax",document.cookie="authToken=; path=/; max-age=0; SameSite=Lax",document.cookie="authToken=; path=/; domain=; expires=Thu, 01 Jan 1970 00:00:00 GMT"},m=async()=>{try{let e=localStorage.getItem("authToken");if(!e)return void u(!1);let t=await fetch("".concat(d,"/auth/me"),{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(t.ok){let e=await t.json(),a=e.id||e.userId,r=e.name||e.fullName||e.email,[o="",i=""]=r.split(" ");s({id:a,email:e.email,name:r,firstName:o,lastName:i,role:e.role,avatar:e.profilePhoto,isPremium:e.isPremium,premiumCredits:e.premiumCredits||0,phones:e.phones||[],emails:e.emails||[],address:e.address||"",birthDate:e.birthDate||""})}else p(),s(null)}catch(e){p(),s(null)}finally{u(!1)}},f=async(e,t)=>{try{u(!0);let f=await fetch("".concat(d,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),y=await f.json();if(!f.ok)return{success:!1,error:y.message||y.error||"Giriş yapılamadı"};{var a,r,o,i,n,l,c,p,m;h(y.token||y.accessToken);let t=(null==(a=y.user)?void 0:a.name)||(null==(r=y.user)?void 0:r.fullName)||(null==(o=y.user)?void 0:o.email),[u="",d=""]=t.split(" "),f={id:(null==(i=y.user)?void 0:i.id)||y.userId,email:(null==(n=y.user)?void 0:n.email)||e,name:t,firstName:u,lastName:d,role:null==(l=y.user)?void 0:l.role,avatar:null==(c=y.user)?void 0:c.avatar,isPremium:null==(p=y.user)?void 0:p.isPremium,premiumCredits:(null==(m=y.user)?void 0:m.premiumCredits)||0};return s(f),{success:!0}}}catch(e){return{success:!1,error:"Bağlantı hatası. L\xfctfen daha sonra tekrar deneyin."}}finally{u(!1)}},y=async(e,t,a,r)=>{try{u(!0);let f=await fetch("".concat(d,"/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:e,lastName:t,email:a,password:r})}),y=await f.json();if(!f.ok)return{success:!1,error:y.message||y.error||"Kayıt olunamadı"};{var o,i,n,l,c,p,m;h(y.token||y.accessToken);let r=(null==(o=y.user)?void 0:o.fullName)||"".concat(e," ").concat(t),u={id:(null==(i=y.user)?void 0:i.id)||y.userId,email:(null==(n=y.user)?void 0:n.email)||a,name:r,firstName:e,lastName:t,role:null==(l=y.user)?void 0:l.role,avatar:null==(c=y.user)?void 0:c.avatar,isPremium:null==(p=y.user)?void 0:p.isPremium,premiumCredits:(null==(m=y.user)?void 0:m.premiumCredits)||0};return s(u),{success:!0}}}catch(e){return{success:!1,error:"Bağlantı hatası. L\xfctfen daha sonra tekrar deneyin."}}finally{u(!1)}},w=async()=>{await m()},g=async e=>{try{let t=localStorage.getItem("authToken");if(!t)return{success:!1,error:"Yetkilendirme hatası"};let r=await fetch("".concat(d,"/auth/profile-from-cv"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({fullName:e.fullName,phones:e.phones,emails:e.emails,address:e.address,profilePhoto:e.profilePhoto,birthDate:e.birthDate?new Date(e.birthDate).toISOString():null})});if(!r.ok){let e=await r.json();throw Error(e.message||"HTTP error! status: ".concat(r.status))}let o=await r.json();if(a){let t=o.fullName||e.fullName,[r="",i=""]=t.split(" ");s({...a,name:t,firstName:r,lastName:i,email:o.email||a.email,avatar:o.profilePhoto||e.profilePhoto||a.avatar,phones:o.phones||e.phones,emails:o.emails||e.emails,address:o.address||e.address,birthDate:o.birthDate||e.birthDate})}return{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Profil g\xfcncellenirken hata oluştu"}}},k=async()=>{try{if(!a||!a.premiumCredits||a.premiumCredits<1)return{success:!1,error:"Yeterli kredi yok"};let e=localStorage.getItem("authToken");if(!e)return{success:!1,error:"Yetkilendirme hatası"};let t=await fetch("".concat(d,"/auth/deduct-premium-credit"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(!t.ok){let e=await t.json();throw Error(e.message||"HTTP error! status: ".concat(t.status))}let r=await t.json();return s({...a,premiumCredits:r.remainingCredits||a.premiumCredits-1}),{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Kredi d\xfcş\xfcrme hatası"}}};return(0,r.jsx)(n.Provider,{value:{user:a,isLoading:l,isAuthenticated:!!a,login:f,register:y,logout:()=>{p(),s(null),c.push("/")},refreshUser:w,updateUserAvatar:e=>{a&&s({...a,avatar:e})},updateUserProfile:g,deductPremiumCredit:k},children:t})}},9869:(e,t,a)=>{a.d(t,{A:()=>r});let r=(0,a(9946).A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},9946:(e,t,a)=>{a.d(t,{A:()=>l});var r=a(2115);let o=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},i=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let s=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:o=24,strokeWidth:s=2,absoluteStrokeWidth:l,className:u="",children:c,iconNode:d,...h}=e;return(0,r.createElement)("svg",{ref:t,...n,width:o,height:o,stroke:a,strokeWidth:l?24*Number(s)/Number(o):s,className:i("lucide",u),...!c&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(h)&&{"aria-hidden":"true"},...h},[...d.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(c)?c:[c]])}),l=(e,t)=>{let a=(0,r.forwardRef)((a,n)=>{let{className:l,...u}=a;return(0,r.createElement)(s,{ref:n,iconNode:t,className:i("lucide-".concat(o(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),l),...u})});return a.displayName=o(e),a}}}]);