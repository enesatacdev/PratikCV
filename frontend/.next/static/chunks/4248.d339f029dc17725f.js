"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4248],{4248:(e,t,o)=>{o.d(t,{C:()=>i,downloadPDF:()=>a,previewPDF:()=>l}),o(9641).Buffer;class i{static optimizeCVData(e){var t,o,i,a,l,r;return{personalInfo:{fullName:(null==(t=e.personalInfo)?void 0:t.fullName)||e.fullName||"",email:(null==(o=e.personalInfo)?void 0:o.email)||e.email||"",phone:(null==(i=e.personalInfo)?void 0:i.phone)||e.phone||"",address:(null==(a=e.personalInfo)?void 0:a.address)||e.address||"",title:(null==(l=e.personalInfo)?void 0:l.title)||e.title||"",profilePhoto:(null==(r=e.personalInfo)?void 0:r.profilePhoto)||e.profilePhoto||""},experiences:(e.experiences||e.experience||[]).slice(0,10).map(e=>({jobTitle:e.jobTitle||e.position||"",company:e.company||"",startDate:e.startDate||"",endDate:e.endDate||"",description:(e.description||"").substring(0,500)})),educations:(e.educations||e.education||[]).slice(0,5).map(e=>({degree:e.degree||"",school:e.school||"",department:e.department||"",startDate:e.startDate||"",endDate:e.endDate||""})),skills:(e.skills||[]).slice(0,20).map(e=>({name:e.name||e,level:e.level||3,category:e.category||"Teknik"})),certificates:(e.certificates||[]).slice(0,10).map(e=>({name:e.name||"",issuer:e.issuer||"",date:e.issueDate||e.date||""})),aboutMe:(e.aboutMe||"").substring(0,1e3),showProfilePhoto:e.showProfilePhoto||!1}}static async downloadPDF(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"modern";try{let o=this.optimizeCVData(e),i=await fetch("".concat(this.baseUrl,"/pdf/generate"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cvData:o,templateId:t,options:{format:"A4",printBackground:!0}})});if(!i.ok)try{let e=await i.json();throw Error(e.error||"Server error: ".concat(i.status))}catch(e){throw Error("Server error: ".concat(i.status))}let a=i.headers.get("content-type");if(a&&a.includes("application/json"))try{let e=await i.json();throw Error(e.error||"PDF generation failed")}catch(e){throw Error("PDF generation failed - invalid JSON response")}let l=await i.blob();if(0===l.size)throw Error("Empty PDF file received");let r=await l.arrayBuffer(),n=new Uint8Array(r);if(!String.fromCharCode(...n.slice(0,4)).startsWith("%PDF"))throw Error("Invalid PDF format received");let s=new Blob([r],{type:"application/pdf"}),f=URL.createObjectURL(s),c="CV_".concat(new Date().getTime(),".pdf"),d=document.createElement("a");d.href=f,d.download=c,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(f)}catch(e){throw e}}static async previewPDF(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"modern";try{let o=this.optimizeCVData(e),i=await fetch("".concat(this.baseUrl,"/pdf/generate"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cvData:o,templateId:t,options:{format:"A4",printBackground:!0}})});if(!i.ok){let e=i.headers.get("content-type");if(e&&e.includes("application/json"))try{let e=await i.json();throw Error(e.error||"PDF generation failed")}catch(e){throw Error("Server error: ".concat(i.status))}else throw Error("Server error: ".concat(i.status))}let a=i.headers.get("content-type");if(a&&a.includes("application/json"))try{let e=await i.json();throw Error(e.error||"PDF generation failed")}catch(e){throw Error("PDF generation failed - invalid response")}let l=await i.blob(),r=URL.createObjectURL(l);window.open(r,"_blank"),setTimeout(()=>{URL.revokeObjectURL(r)},5e3)}catch(e){throw e}}static async getThumbnailImage(e){var t,o,i;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"modern";try{let i=document.createElement("canvas");i.width=300,i.height=400;let l=i.getContext("2d");if(!l)throw Error("Canvas context not available");l.fillStyle="#ffffff",l.fillRect(0,0,i.width,i.height),l.strokeStyle="#e5e7eb",l.lineWidth=2,l.strokeRect(0,0,i.width,i.height),l.fillStyle="#f9fafb",l.fillRect(10,10,i.width-20,80),l.fillStyle="#1f2937",l.font="bold 16px Arial",l.textAlign="center";let r=(null==(t=e.personalInfo)?void 0:t.firstName)?"".concat(e.personalInfo.firstName," ").concat(e.personalInfo.lastName||""):(null==(o=e.personalInfo)?void 0:o.fullName)||"CV \xd6nizlemesi";l.fillText(r,i.width/2,35),l.fillStyle="#6b7280",l.font="12px Arial",l.fillText("".concat(a," Şablonu"),i.width/2,55),l.fillStyle="#e5e7eb";for(let e=0;e<15;e++){let t=110+15*e,o=200*Math.random()+50;l.fillRect(20,t,o,8)}return l.fillStyle="#3b82f6",l.font="bold 14px Arial",l.textAlign="left",l.fillText("Kişisel Bilgiler",20,130),l.fillText("Deneyim",20,190),l.fillText("Eğitim",20,250),l.fillText("Yetenekler",20,310),i.toDataURL("image/png")}catch(t){return"data:image/svg+xml;base64,".concat(btoa('\n        <svg width="300" height="400" xmlns="http://www.w3.org/2000/svg">\n          <rect width="300" height="400" fill="#f3f4f6" stroke="#e5e7eb" stroke-width="2"/>\n          <text x="150" y="50" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold" fill="#1f2937">\n            '.concat((null==(i=e.personalInfo)?void 0:i.fullName)||"CV \xd6nizlemesi",'\n          </text>\n          <text x="150" y="70" text-anchor="middle" font-family="Arial" font-size="12" fill="#6b7280">\n            ').concat(a,' Şablonu\n          </text>\n          <rect x="20" y="90" width="260" height="280" fill="none" stroke="#e5e7eb" stroke-width="1"/>\n          <text x="30" y="110" font-family="Arial" font-size="14" font-weight="bold" fill="#3b82f6">Kişisel Bilgiler</text>\n          <text x="30" y="150" font-family="Arial" font-size="14" font-weight="bold" fill="#3b82f6">Deneyim</text>\n          <text x="30" y="190" font-family="Arial" font-size="14" font-weight="bold" fill="#3b82f6">Eğitim</text>\n          <text x="30" y="230" font-family="Arial" font-size="14" font-weight="bold" fill="#3b82f6">Yetenekler</text>\n        </svg>\n      ')))}}static async getAvailableTemplates(){try{let e=await fetch("".concat(this.baseUrl,"/templates"));if(!e.ok)throw Error("Failed to fetch templates");let t=await e.json();return t.success?t.data:[]}catch(e){return[]}}}i.baseUrl="/api";let a=i.downloadPDF.bind(i),l=i.previewPDF.bind(i)}}]);